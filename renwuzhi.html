<!DOCTYPE html>
<!--
Copyright 2023 hanyuduan@outlook.com

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html>
  <head>
    <meta charset="utf-8">
    <script charset="utf-8">
      const my_email = "hanyuduan@outlook.com";
      const github_page = "https://github.com/hydawn/renwuzhi/issues";
      // TODO: use aerror everywhere
      function aerror(msg) {
        alert(msg + `恭喜你发现了bug。如果你有空可以把你怎么发现它的告诉我${my_email}。或者提issue: ${github_page} 。不胜感激。`);
      }
    </script>
    <!-- 人物志转换“脚本”唯一版本定义处 -->
    <title>人物志转换 v0.1.6 2025-11-05 10:06</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/progressing-bar.css" type="text/css" media="all">
    <link rel="stylesheet" href="css/loading-dot.css" type="text/css" media="all">
    <link rel="stylesheet" href="css/renwuzhi.css" type="text/css" media="all">
  </head>
  <body>
    <div>
      <label><input type="checkbox" id="through-mode" checked>上传文件直接出结果模式</label>
      <label><input type="checkbox" id="simple-mode" checked>简洁模式</label>
      <script src="control_mode.js"></script>
      <div class="help hide">
        <h2>运行之前</h2>
        <div class="content">
          <p>
          某一步的说明没看懂没关系，无脑<b style="color: red;">下一步</b>就行了
          </p>
          <p>
          如果你某一步做错了，比如选了你不该选的，请刷新页面重新上传<br>
          但是如果你一不小心刷新页面了，哈哈哈那你只能重新上传了<br>
          </p>
          <p>
          一般来说，当你点击某个按钮之后发现网页一点反应也没有，可能就是出错了<br>
          这时候你可以按Ctrl+Shift+I打开控制台看看出了什么问题，
          或者联系我，如果你不知道我是谁，我的联系方式在网页最下面
          </p>
        </div>
      </div>

      <br>

      <h2 id="main-title">开始转换！</h2>
      <div class="content">
        <div class="input" id="import_file_details">
          <div class="help hide">
            首先你需要上传人物志问卷结果文件，现在仅支持xls(x)格式<br>
            如果你已经把表格文件下载到了本地，就使用下面的 <b>从本地导入</b><br>
            如果你手头有一个（问卷星结果）文件下载链接，就点击下面的 <b>从文件链接导入</b><br>
            其实，如果文件链接下载失败（你发现网页半天没反应），你还是得手动下载然后从本地导入<br>
            注意数据需在第一表格里，但是一般都会在第一表格里所以其实你不需要注意<br>
            如果你发现上传文件之后没反应，说明网页卡死了，恭喜你发现了bug，如果你感兴趣可以把你的文件发过来我看看怎么个事<br>
          </div>
          <details>
            <summary><b>从本地导入xls(x)文件</b></summary>
            <span>上传xls(x)文件：</span>
            <input type="file" id="file_input">
          </details>

          <details open>
            <summary><b>从文件链接导入</b></summary>
            <span>导出excel网址贴到这里（比如问卷星下载地址）：</span>
            <input type="text" id="url_input" value="">
            <button type="button" id="urlOKButton" onclick="getFileUrl()">贴好了</button>
            <span id="downloading-from-url" class="hide">
              下载中
              <span class="loading-container">
                <span class="loading-dot"></span>
                <span class="loading-dot"></span>
                <span class="loading-dot"></span>
              </span>
            </span>
          </details>
        </div>

        <div>
          <h3 id="prompt_title"></h3>
          <div id="prompt_body" class="help hide"></div>
        </div>
        <div id="html_selector_list"></div>

        <div class="trans-result">
          <div id="picture_section" class="hide">
            <div class="download-picture-section">
              <button id="hit_download_images_button" onclick="handleClickDownloadImage()">点击下载所有图片</button>
              <span id="loading-from-image" class="hide">
                下载中
                <span class="loading-container">
                  <span class="loading-dot"></span>
                  <span class="loading-dot"></span>
                  <span class="loading-dot"></span>
                </span>
                （可能要下个半分钟吧
                <span id="progressing-bar"></span>
              </span>
              <div id="hit_download_links" class="hide">
                下载成功！
                <a id="hit_download_images">再次下载所有图片</a>
              </div>
            </div>
            <details>
              <summary><b>转换结果 -- 照片（点击展开）</b></summary>
              <p>
              右键复制原图，可以直接粘贴到秀米（大概吧<br/>
              如果你只看到一堆网址说明网址过期了，重新导出一下
              </p>
              <div id="picture_result_question"></div>
              <div id="gallery" class="gallery"></div>
            </details>
          </div>
          <div id="text_section" class="hide">
            <details>
              <summary><b>转换结果（点击展开）</b></summary>
              <div id="pure_text_result"></div>
            </details>
            <details>
              <summary><b>转换结果 -- 富文本 （点击展开）</b></summary>
              <input type="checkbox" id="reverse-color-button" checked>反色</input> -- 秀米中反选“粘贴时清除格式”用于登协模板
              <div id="rich_text_result" class="color-reversed">
              </div>
            </details>
          </div>
          <div id="file_section"></div>

          <!-- I put the script here is for them to load before a 32K picture is loaded -->
          <script src="loadfile.js"></script>
          <script src="progressing_bar.js"></script>
          <script src="dlpic.js"></script>
          <script src="process_xlsx.js"></script>
          <script src="load_mode.js"></script>

          <div class="hide" id="rich_text_tutorial">
            <details>
              <summary>如果你粘贴到秀米后发现格式不对并且不能调整，点这里</summary>
              <p>
              可能因为你把<b>设置</b>中<b>粘贴时清除格式</b>点掉了，所以连带格式都一起被粘贴到了秀米里
              <br>
              有时候你想粘贴格式，有时候不想。多试试。
              </p>
              <img src="秀米_粘贴时清除格式.png" type="image/png">
            </details>
          </div>
        </div>
      </div>

      <br>


      <div class="help hide">
        <h2>开始聊天！</h2>
        <div>

          <p>
          在线版 <a href="https://hikerjoy.duckdns.org/renwuzhi/">https://hikerjoy.duckdns.org/renwuzhi/</a><br/>
          但是在线版，哪天我不关心了，不维护了，就挂了。关心的可以<code>Ctrl+S</code>保存一个离线版，离线版用浏览器打开一样能用
          </p>

          <details>
            <summary>但是因为内向所以默认折叠</summary>
            <div class="聊天">
              <p>
              有的朋友可能会考虑数据安全问题。这里所谓的上传是指上传到你的浏览器中，并不会上传到网络上，所有的数据处理都在浏览器中进行，所以这个程序断网也可以使用<br>
              不过呢，如果你不是很懂，其实我再怎么说你也不知道我对你的数据做了什么，你只需要相信给你程序的那个人，那个人再往前相信给他程序的人，最终相信我。
              </p>
              <p>
              不相信我你也没招，嘿嘿嘿
              </p>
              <p>
              我发现，这种方法真的很原始，但是很简单，很通用，支持各种平台。活得也很久。<br>
              小程序没了解过不想写，网站可以搭但谁维护呢？服务器不续费了怎么办？域名无了怎么办？<br>
              刚开始的python脚本，我也写了一个教程，教大家怎么用python，可能是我没有大力推广，最后看教程的人并不多。<br>
              后来我考虑，要不打包成一个可执行文件。windows上很简单，各种版本的windows都能兼容，<br>
              不过怎么打包成mac上的app呢？有点懒得实验了。<br>
              不过正巧我最近也想看看javascript，于是干脆把python脚本扔了，重新写一个“html程序”，能用就行。<br>
              然后就是注意xlsx.full.min.js是别人家的代码。<br>
              官网是这个<a href="https://sheetjs.com/">https://sheetjs.com/</a><br>
              apache licence我也没研究过，大家自己用用也无所谓<br>
              </p>
              <p>
              写这个程序有一种“古法酿造”的感觉，
              放着现代的框架不用非得要玩原始
              </p>
              <p>
              2024-10-17 10:09
              v0.1.1
              更新一下，现在不用sheetjs了，那个太大了，改用<a href="https://stuk.github.io/jszip/">JSZip - https://stuk.github.io/jszip/</a>解压xlsx然后自己找sheet1<br>
              现在文件大小小很多
              JSZip is dual-licensed. You may use it under the MIT license or the GPLv3 license
              还没研究过，下一版再说吧
              </p>

              <!--
                <p>
                2023-11-17 08:44<br>
                但我还是想主动暗示大家创作的自由<br>
                用了十几年的迅雷，有一次偶然机会开始用qbittorrent。才亲眼看见自己下载的
                内容是怎么上传给别人的。才知道问什么有人说“下载的人越多、越热门的资源下载
                的速度越快”。才知道自己也可以分享自己的上传带宽来帮助更多的人。原来我除了
                索取，还有给予的能力。<br>
                我以前确实对这种p2p下载的原理不感兴趣。但当我第一次看见一个下载软件，
                除了下载速度之外，还有上传速度，我立刻被这种分享的概念吸引
                住了。但如果qbittorrent的开发者也抱有一种“感兴趣的人自然会了解”的
                心态，可能到我用qbittorrent的时候，还是对上传一无所知，还是只会问别人要资源。
                而现在我不仅可以从图书馆里拿书，我还可以是图书馆的一部分<br>
                我觉得这是一个软件定位的问题。我希望我的软件，即使在很小的范围内，即使有
                很微弱的效果，即使在一个很简单的功能上，也能尽量启发别人，你可以在自己的
                生活中，任何地方，添加一些小花样。而不是等待别人开始追求花样了，我再给别人
                更丰富的选择。我想一开始就暗示你，你有的选。<br>
                最后一步只有一个选项，而且已经帮你选好了，当然了，你也可以什么都不选。
                </p>

                <p>
                2024-10-15 08:18
                fix:
                下载txt文件会出现多余的逗号
                feat:
                可查看图片
                应对一个队员提交多次的情况
                默认上传url直接出结果
                todo: 批量下载图片，极速模式（直接跳过所有过程），简洁模式（没有帮助和提示）
                </p>
              -->

              <p>
              有局call我
              </p>
            </div>
          </details>
          <p>
          微信19965909565<br/>hanyuduan@outlook.com
          </p>
        </div>
      </div>
    </div>
    <script src="jszip.min.js"></script>
    <script src="xlsxjs.js"></script>
  </body>
</html>
