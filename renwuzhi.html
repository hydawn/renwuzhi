<!DOCTYPE html>
<!--
Copyright 2023 dawn

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

用了别人的代码，也用人家的licence咯
-->
<html>
  <head>
    <meta charset="utf-8">
    <title>人物志转换 v0.0.2</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <style>
/* padding: top right down left */
body {
  padding: 1% 10% 10% 10%;
  font-family: 'Times New Roman', serif, 'Noto Sans CJK SC';
  font-size: 100%;
}
.trans_result {
  padding: 1% 5% 0% 5%;
}
/*
.rich_result {
}
*/
    </style>
  </head>
  <body>

    <h2>运行之前</h2>
    <div class="content">
      <p>
      某一步的说明没看懂没关系，无脑下一步就行了
      </p>
      <p>
      如果你某一步做错了，比如选了你不该选的，请刷新页面重新上传<br>
      但是如果你一不小心刷新页面了，哈哈哈那你只能重新上传了<br>
      </p>
      <p>
      一般来说，当你点击某个按钮之后发现网页一点反应也没有，可能就是出错了<br>
      这时候你可以按Ctrl+Shift+I打开控制台看看出了什么问题，
      或者联系我，如果你不知道我是谁，我的联系方式在网页最下面
      </p>
    </div>

    <br>

    <h2>开始转换！</h2>
    <div class="content">
    <div class="input" id="import_file_details">
      首先你需要上传人物志问卷结果文件，现在仅支持xls(x)格式<br>
      如果你已经把表格文件下载到了本地，就点击下面的 <b>从本地导入</b><br>
      如果你手头有一个（问卷星结果）文件下载链接，就点击下面的 <b>从文件链接导入</b><br>
      其实，如果文件链接下载失败（你发现网页半天没反应），你还是得手动下载然后从本地导入
      <details open>
        <summary><b>从本地导入</b></summary>
        <div class="input-loadfile">
        <h2>上传xls(x)文件</h2>
        注意数据需在第一表格里，但是一般都会在第一表格里所以其实你不需要注意<br>
        <input type="file" id="file_input" name="name 有什么用呢？ 点击这里上传文件 HIT IT!">
        </div>
      </details>

      <details>
        <summary><b>从文件链接导入</b></summary>
        <div id="url_input_div">
        <h2>把导出excel网址贴到这里 （问卷星下载地址什么的）</h2>
        <!-- debug -->
        <!-- <input type="text" id="url_input" value="http://localhost:10880/241183365_0_宁海人物志收集_19_19.xlsx"> -->
        <input type="text" id="url_input" value="">
        <button type="button" onclick="get_file_url()">贴好了</button>
        </div>
      </details>
    </div>

    <p id="html_selector_field"></p>
    <div class="trans_result" id="transposition_result_field">
      <div id="transposition_result_text_div"></div>
      <div id="transposition_result_file_div"></div>
      <div class="rich_result" id="rich_text_tutorial" style="display:none">
        <details>
          <summary>如果你粘贴到秀米后发现格式不对并且不能调整，点这里</summary>
          <p>
          因为你把<b>设置</b>中<b>粘贴时清除格式</b>点掉了，所以连带格式都一起被粘贴到了秀米里
          <br>
          养成好习惯，粘贴纯文本
          </p>
        </details>
        <!-- <img src="秀米_粘贴时清除格式.png" type="image/png"> -->
      </div>
    </div>
    </div>

    <!-- <script lang="javascript" src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script> -->
    <!-- <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script> -->
    <script src="xlsx.full.min.js"></script>
    <!-- <script src="processcsv.js"></script> -->
    <script src="queryfile.js"></script>
    <script src="loadfile.js"></script>
    <script src="process_xlsx.js"></script>
    <br>


    <h2>开始聊天！</h2>
    <div class="content">
    <details>
    <summary>但是因为内向所以默认折叠</summary>
    <div class="聊天">
      <p>
      有的朋友可能会考虑数据安全问题。这里所谓的上传是指上传到你的浏览器中，并不会上传到网络上，所有的数据处理都在浏览器中进行，所以这个程序断网也可以使用<br>
      不过呢，如果你不是很懂，其实我再怎么说你也不知道我对你的数据做了什么，你只需要相信给你程序的那个人，那个人再往前相信给他程序的人，最终相信我。
      </p>
      <p>
      不相信我你也没招，嘿嘿嘿
      </p>
      <p>
      我发现，这种方法真的很原始，但是很简单，很通用，支持各种平台。活得也很久。<br>
      小程序没了解过不想写，网站可以搭但谁维护呢？服务器不续费了怎么办？域名无了怎么办？<br>
      刚开始的python脚本，我也写了一个教程，教大家怎么用python，可能是我没有大力推广，最后看教程的人并不多。<br>
      后来我考虑，要不打包成一个可执行文件。windows上很简单，各种版本的windows都能兼容，<br>
      不过怎么打包成mac上的app呢？有点懒得实验了。<br>
      不过正巧我最近也想看看javascript，于是干脆把python脚本扔了，重新写一个“html程序”，能用就行。<br>
      然后就是注意xlsx.full.min.js是别人家的代码。<br>
      官网是这个<a href="https://sheetjs.com/">https://sheetjs.com/</a><br>
      apache licence我也没研究过，大家自己用用也无所谓<br>
      </p>
      <p>
      写这个程序有一种“古法酿造”的感觉，
      放着现代的框架不用非得要玩原始
      </p>

      <!--
      <p>
      2023-11-17 08:44<br>
      但我还是想主动暗示大家创作的自由<br>
      用了十几年的迅雷，有一次偶然机会开始用qbittorrent。才亲眼看见自己下载的
      内容是怎么上传给别人的。才知道问什么有人说“下载的人越多、越热门的资源下载
      的速度越快”。才知道自己也可以分享自己的上传带宽来帮助更多的人。原来我除了
      索取，还有给予的能力。<br>
      我以前确实对这种p2p下载的原理不感兴趣。但当我第一次看见一个下载软件，
      除了下载速度之外，还有上传速度，我立刻被这种分享的概念吸引
      住了。但如果qbittorrent的开发者也抱有一种“感兴趣的人自然会了解”的
      心态，可能到我用qbittorrent的时候，还是对上传一无所知，还是只会问别人要资源。
      而现在我不仅可以从图书馆里拿书，我还可以是图书馆的一部分<br>
      我觉得这是一个软件定位的问题。我希望我的软件，即使在很小的范围内，即使有
      很微弱的效果，即使在一个很简单的功能上，也能尽量启发别人，你可以在自己的
      生活中，任何地方，添加一些小花样。而不是等待别人开始追求花样了，我再给别人
      更丰富的选择。我想一开始就暗示你，你有的选。<br>
      最后一步只有一个选项，而且已经帮你选好了，当然了，你也可以什么都不选。
      </p>
      -->

      <p>
      有局call我
      </p>
    </div>
    </details>
    <p>
    微信19965909565
    </p>
    </div>

  </body>
</html>
